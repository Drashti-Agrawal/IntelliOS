2025-08-21 00:40:41,811 [INFO] root:64 - Logging initialized at COMPREHENSIVE level
2025-08-21 00:40:41,811 [DEBUG] root:66 - Debug logging is enabled
2025-08-21 00:40:41,811 [INFO] __main__:119 - ================================================================================
2025-08-21 00:40:41,812 [INFO] __main__:120 - IntelliOS Log Processing System
2025-08-21 00:40:41,812 [INFO] __main__:121 - ================================================================================
2025-08-21 00:40:41,812 [INFO] __main__:122 - Logging level: COMPREHENSIVE
2025-08-21 00:40:41,812 [INFO] __main__:64 - Starting log processing for channel 'System' since 2025-08-20 18:10:41.812632+00:00
2025-08-21 00:40:41,813 [INFO] log_fetcher:14 - Opening event log channel: 'System'
2025-08-21 00:40:41,823 [DEBUG] log_fetcher:32 - Read a chunk of 11 events.
2025-08-21 00:40:41,823 [DEBUG] log_fetcher:48 - Yielding event from 'Service Control Manager' at 2025-08-21 00:28:13+00:00. Message: Background Intelligent Transfer Service auto start demand start BITS...
2025-08-21 00:40:41,824 [INFO] regex_parsers:193 - Attempting regex parsing for provider: 'Service Control Manager'
2025-08-21 00:40:41,825 [DEBUG] regex_parsers:196 - Found matching provider in registry. Trying regex: (?:The )?(?P<service_name>[^%\s]+)(?:.*?service entered the )(?P<state>\w+)(?:.*)|\s*(?P<service_name_alt>[^%\s]+)(?:\s+)(?P<action>\w+\s+\w+)(?:\s+)(?P<details>.*)
2025-08-21 00:40:41,825 [INFO] regex_parsers:199 - Successfully parsed log from 'Service Control Manager' with regex.
2025-08-21 00:40:41,825 [DEBUG] regex_parsers:22 - Regex handler 'handle_service_control' matched groups: {'service_name': None, 'state': None, 'service_name_alt': 'Background', 'action': 'Intelligent Transfer', 'details': 'Service auto start demand start BITS'}
2025-08-21 00:40:41,825 [DEBUG] log_fetcher:48 - Yielding event from 'Service Control Manager' at 2025-08-21 00:25:31+00:00. Message: Background Intelligent Transfer Service demand start auto start BITS...
2025-08-21 00:40:41,826 [INFO] regex_parsers:193 - Attempting regex parsing for provider: 'Service Control Manager'
2025-08-21 00:40:41,827 [DEBUG] regex_parsers:196 - Found matching provider in registry. Trying regex: (?:The )?(?P<service_name>[^%\s]+)(?:.*?service entered the )(?P<state>\w+)(?:.*)|\s*(?P<service_name_alt>[^%\s]+)(?:\s+)(?P<action>\w+\s+\w+)(?:\s+)(?P<details>.*)
2025-08-21 00:40:41,828 [INFO] regex_parsers:199 - Successfully parsed log from 'Service Control Manager' with regex.
2025-08-21 00:40:41,828 [DEBUG] regex_parsers:22 - Regex handler 'handle_service_control' matched groups: {'service_name': None, 'state': None, 'service_name_alt': 'Background', 'action': 'Intelligent Transfer', 'details': 'Service demand start auto start BITS'}
2025-08-21 00:40:41,828 [DEBUG] log_fetcher:48 - Yielding event from 'Microsoft-Windows-Kernel-Power' at 2025-08-20 23:46:46+00:00. Message: 21 32 158 1 259961883 34439 34439 34439 34439 160 0 true 32...
2025-08-21 00:40:41,828 [INFO] regex_parsers:193 - Attempting regex parsing for provider: 'Microsoft-Windows-Kernel-Power'
2025-08-21 00:40:41,829 [DEBUG] regex_parsers:196 - Found matching provider in registry. Trying regex: (?:The system is entering sleep\.|The system is exiting sleep\.|(?:Sleep|Hibernate) Time: (?P<sleep_time>.*))(?P<sleep_details>.*)?|(?:Shutdown reason: (?P<shutdown_reason>.*))(?P<shutdown_details>.*)?|(?P<message>.*)
2025-08-21 00:40:41,829 [INFO] regex_parsers:199 - Successfully parsed log from 'Microsoft-Windows-Kernel-Power' with regex.
2025-08-21 00:40:41,829 [DEBUG] regex_parsers:45 - Regex handler 'handle_kernel_power' matched groups: {'sleep_time': None, 'sleep_details': None, 'shutdown_reason': None, 'shutdown_details': None, 'message': '21 32 158 1 259961883 34439 34439 34439 34439 160 0 true 32'}
2025-08-21 00:40:41,829 [DEBUG] log_fetcher:48 - Yielding event from 'Microsoft-Windows-Kernel-Power' at 2025-08-20 23:46:46+00:00. Message: 0 259967187 0 0 0 259967187 0 83 true 32 32363743 0 true 0 274579 false true 0 7 0 true false 160 fa...
2025-08-21 00:40:41,830 [INFO] regex_parsers:193 - Attempting regex parsing for provider: 'Microsoft-Windows-Kernel-Power'
2025-08-21 00:40:41,830 [DEBUG] regex_parsers:196 - Found matching provider in registry. Trying regex: (?:The system is entering sleep\.|The system is exiting sleep\.|(?:Sleep|Hibernate) Time: (?P<sleep_time>.*))(?P<sleep_details>.*)?|(?:Shutdown reason: (?P<shutdown_reason>.*))(?P<shutdown_details>.*)?|(?P<message>.*)
2025-08-21 00:40:41,830 [INFO] regex_parsers:199 - Successfully parsed log from 'Microsoft-Windows-Kernel-Power' with regex.
2025-08-21 00:40:41,831 [DEBUG] regex_parsers:45 - Regex handler 'handle_kernel_power' matched groups: {'sleep_time': None, 'sleep_details': None, 'shutdown_reason': None, 'shutdown_details': None, 'message': '0 259967187 0 0 0 259967187 0 83 true 32 32363743 0 true 0 274579 false true 0 7 0 true false 160 false 34439 34439 158 21 0 259967187 0 0 0 0 272169 false 34439 34439 259961883 0 0 0 34439 34439 0 0 4 0'}
2025-08-21 00:40:41,831 [DEBUG] log_fetcher:48 - Yielding event from 'Microsoft-Windows-WindowsUpdateClient' at 2025-08-20 23:44:08+00:00. Message: Security Intelligence Update for Microsoft Defender Antivirus - KB2267602 (Version 1.435.286.0) - Cu...
2025-08-21 00:40:41,831 [INFO] regex_parsers:193 - Attempting regex parsing for provider: 'Microsoft-Windows-WindowsUpdateClient'
2025-08-21 00:40:41,831 [INFO] regex_parsers:201 - No regex match found for provider 'Microsoft-Windows-WindowsUpdateClient'.
2025-08-21 00:40:41,831 [INFO] __main__:80 - Regex failed for provider 'Microsoft-Windows-WindowsUpdateClient'. Trying LLM...
2025-08-21 00:40:41,831 [INFO] llm_layer:33 - Attempting LLM parsing for provider: 'Microsoft-Windows-WindowsUpdateClient'
2025-08-21 00:40:41,838 [DEBUG] instructor:1276 - Instructor Request: mode.value='tool_call', response_model=<class 'config.ActivityLog'>, new_kwargs={'model': 'llama3-70b-8192', 'messages': [{'role': 'system', 'content': 'You are a world-class log parsing expert. Your task is to extract structured data from a raw log entry into the provided schema. Do not invent any information that is not present in the log. Categorize the event type accurately based on the provider and content.'}, {'role': 'user', 'content': 'Provider: Microsoft-Windows-WindowsUpdateClient\n\nLog entry: Security Intelligence Update for Microsoft Defender Antivirus - KB2267602 (Version 1.435.286.0) - Current Channel (Broad) {d1b0bb57-4a31-4742-b435-ec19cc36e9b0} 200 {9482f4b4-e343-43b6-b170-9a65bc822c77}\n\nParse this log entry into structured data according to the ActivityLog schema.'}], 'tools': [{'type': 'function', 'function': {'name': 'ActivityLog', 'description': 'Schema for a single structured log event.', 'parameters': {'properties': {'event_type': {'description': 'The high-level category of the event.', 'enum': ['file_interaction', 'app_lifecycle', 'system_event', 'application_crash', 'service_event', 'power_event', 'dcom_event', 'file_system_event', 'unknown'], 'title': 'Event Type', 'type': 'string'}, 'event_subtype': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'A more specific categorization within the event type.', 'title': 'Event Subtype'}, 'app_name': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'The name of the application involved.', 'title': 'App Name'}, 'file_path': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'The full path to the file involved.', 'title': 'File Path'}, 'status': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'Status or result of the event.', 'title': 'Status'}, 'operation_code': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'Operation code for events that use them.', 'title': 'Operation Code'}, 'summary': {'description': 'A brief, factual summary of the log entry.', 'title': 'Summary', 'type': 'string'}}, 'required': ['event_type', 'summary'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ActivityLog'}}}
2025-08-21 00:40:41,839 [DEBUG] instructor:61 - max_retries: 1, timeout: None
2025-08-21 00:40:41,840 [DEBUG] instructor:183 - Retrying, attempt: 1
2025-08-21 00:40:41,842 [DEBUG] groq._base_client:480 - Request options: {'method': 'post', 'url': '/openai/v1/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-b530a51f-845f-4e33-b143-c37edd32322c', 'json_data': {'messages': [{'role': 'system', 'content': 'You are a world-class log parsing expert. Your task is to extract structured data from a raw log entry into the provided schema. Do not invent any information that is not present in the log. Categorize the event type accurately based on the provider and content.'}, {'role': 'user', 'content': 'Provider: Microsoft-Windows-WindowsUpdateClient\n\nLog entry: Security Intelligence Update for Microsoft Defender Antivirus - KB2267602 (Version 1.435.286.0) - Current Channel (Broad) {d1b0bb57-4a31-4742-b435-ec19cc36e9b0} 200 {9482f4b4-e343-43b6-b170-9a65bc822c77}\n\nParse this log entry into structured data according to the ActivityLog schema.'}], 'model': 'llama3-70b-8192', 'tool_choice': {'type': 'function', 'function': {'name': 'ActivityLog'}}, 'tools': [{'type': 'function', 'function': {'name': 'ActivityLog', 'description': 'Schema for a single structured log event.', 'parameters': {'properties': {'event_type': {'description': 'The high-level category of the event.', 'enum': ['file_interaction', 'app_lifecycle', 'system_event', 'application_crash', 'service_event', 'power_event', 'dcom_event', 'file_system_event', 'unknown'], 'title': 'Event Type', 'type': 'string'}, 'event_subtype': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'A more specific categorization within the event type.', 'title': 'Event Subtype'}, 'app_name': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'The name of the application involved.', 'title': 'App Name'}, 'file_path': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'The full path to the file involved.', 'title': 'File Path'}, 'status': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'Status or result of the event.', 'title': 'Status'}, 'operation_code': {'anyOf': [{'type': 'string'}, {'type': 'null'}], 'default': None, 'description': 'Operation code for events that use them.', 'title': 'Operation Code'}, 'summary': {'description': 'A brief, factual summary of the log entry.', 'title': 'Summary', 'type': 'string'}}, 'required': ['event_type', 'summary'], 'type': 'object'}}}]}}
2025-08-21 00:40:42,022 [DEBUG] groq._base_client:976 - Sending HTTP Request: POST https://api.groq.com/openai/v1/chat/completions
2025-08-21 00:40:42,023 [DEBUG] httpcore.connection:47 - connect_tcp.started host='api.groq.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-08-21 00:40:42,170 [DEBUG] httpcore.connection:47 - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000022AFFE74440>
2025-08-21 00:40:42,171 [DEBUG] httpcore.connection:47 - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000022AFF10C4B0> server_hostname='api.groq.com' timeout=5.0
2025-08-21 00:40:42,260 [DEBUG] httpcore.connection:47 - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000022AFFDAD450>
2025-08-21 00:40:42,262 [DEBUG] httpcore.http11:47 - send_request_headers.started request=<Request [b'POST']>
2025-08-21 00:40:42,263 [DEBUG] httpcore.http11:47 - send_request_headers.complete
2025-08-21 00:40:42,263 [DEBUG] httpcore.http11:47 - send_request_body.started request=<Request [b'POST']>
2025-08-21 00:40:42,263 [DEBUG] httpcore.http11:47 - send_request_body.complete
2025-08-21 00:40:42,264 [DEBUG] httpcore.http11:47 - receive_response_headers.started request=<Request [b'POST']>
2025-08-21 00:40:43,221 [DEBUG] httpcore.http11:47 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 20 Aug 2025 19:10:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'Cache-Control', b'private, max-age=0, no-store, no-cache, must-revalidate'), (b'vary', b'Origin'), (b'x-groq-region', b'bom'), (b'x-ratelimit-limit-requests', b'14400'), (b'x-ratelimit-limit-tokens', b'6000'), (b'x-ratelimit-remaining-requests', b'14399'), (b'x-ratelimit-remaining-tokens', b'5839'), (b'x-ratelimit-reset-requests', b'6s'), (b'x-ratelimit-reset-tokens', b'1.61s'), (b'x-request-id', b'req_01k34e80xhf8s8yq34nj8wdhcr'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=vNoRzHbS9lqBAkk_Etgc1IqtrmmMPILhEzLtrivlsBw-1755717043-1.0.1.1-3KMlFai4gHUqMUE.v793jR.pnmF_415YgCQh4KBvlJUJRsxRTzMBYBs7lD5JMR2WKYuSd_jSa7j95BrGLpPwtXDDTfbCz3aqOcUc7VhnBdY; path=/; expires=Wed, 20-Aug-25 19:40:43 GMT; domain=.groq.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9724313f3d7aca22-BOM'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-08-21 00:40:43,224 [INFO] httpx:1025 - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-21 00:40:43,225 [DEBUG] httpcore.http11:47 - receive_response_body.started request=<Request [b'POST']>
2025-08-21 00:40:43,226 [DEBUG] httpcore.http11:47 - receive_response_body.complete
2025-08-21 00:40:43,226 [DEBUG] httpcore.http11:47 - response_closed.started
2025-08-21 00:40:43,227 [DEBUG] httpcore.http11:47 - response_closed.complete
2025-08-21 00:40:43,227 [DEBUG] groq._base_client:1014 - HTTP Response: POST https://api.groq.com/openai/v1/chat/completions "200 OK" Headers({'date': 'Wed, 20 Aug 2025 19:10:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'cache-control': 'private, max-age=0, no-store, no-cache, must-revalidate', 'vary': 'Origin', 'x-groq-region': 'bom', 'x-ratelimit-limit-requests': '14400', 'x-ratelimit-limit-tokens': '6000', 'x-ratelimit-remaining-requests': '14399', 'x-ratelimit-remaining-tokens': '5839', 'x-ratelimit-reset-requests': '6s', 'x-ratelimit-reset-tokens': '1.61s', 'x-request-id': 'req_01k34e80xhf8s8yq34nj8wdhcr', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=vNoRzHbS9lqBAkk_Etgc1IqtrmmMPILhEzLtrivlsBw-1755717043-1.0.1.1-3KMlFai4gHUqMUE.v793jR.pnmF_415YgCQh4KBvlJUJRsxRTzMBYBs7lD5JMR2WKYuSd_jSa7j95BrGLpPwtXDDTfbCz3aqOcUc7VhnBdY; path=/; expires=Wed, 20-Aug-25 19:40:43 GMT; domain=.groq.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '9724313f3d7aca22-BOM', 'alt-svc': 'h3=":443"; ma=86400'})
2025-08-21 00:40:43,240 [DEBUG] instructor:455 - No compatible response.usage found, token usage not updated.
2025-08-21 00:40:43,241 [DEBUG] instructor:155 - Instructor Raw Response: ChatCompletion(id='chatcmpl-9931a60b-096e-4d66-93fd-f174cb63a60d', choices=[Choice(finish_reason='tool_calls', index=0, logprobs=None, message=ChatCompletionMessage(content=None, role='assistant', executed_tools=None, function_call=None, reasoning=None, tool_calls=[ChatCompletionMessageToolCall(id='06xbnvqz6', function=Function(arguments='{"app_name":"Microsoft Defender Antivirus","event_type":"system_event","summary":"Security Intelligence Update for Microsoft Defender Antivirus - KB2267602 (Version 1.435.286.0) - Current Channel (Broad)"}', name='ActivityLog'), type='function')]))], created=1755717043, model='llama3-70b-8192', object='chat.completion', system_fingerprint='fp_bf16903a67', usage=CompletionUsage(completion_tokens=114, prompt_tokens=1436, total_tokens=1550, completion_time=0.204076954, prompt_time=0.112128046, queue_time=0.529141828, total_time=0.316205), usage_breakdown=None, x_groq={'id': 'req_01k34e80xhf8s8yq34nj8wdhcr'}, service_tier='on_demand')
2025-08-21 00:40:43,242 [INFO] llm_layer:42 - LLM parsing successful for provider: 'Microsoft-Windows-WindowsUpdateClient'
2025-08-21 00:40:43,242 [INFO] __main__:85 - Successfully parsed log from 'Microsoft-Windows-WindowsUpdateClient' with LLM.
2025-08-21 00:40:43,242 [DEBUG] log_fetcher:48 - Yielding event from 'Microsoft-Windows-WindowsUpdateClient' at 2025-08-20 23:43:55+00:00. Message: Security Intelligence Update for Microsoft Defender Antivirus - KB2267602 (Version 1.435.286.0) - Cu...
2025-08-21 00:40:43,242 [INFO] __main__:72 - Reached log processing limit of 5
2025-08-21 00:40:43,243 [INFO] log_fetcher:65 - Finished fetching logs from 'System'. Total events yielded: 5.
2025-08-21 00:40:43,244 [INFO] log_fetcher:68 - Event log handle closed.
2025-08-21 00:40:43,244 [INFO] __main__:93 - 
Processing summary:
2025-08-21 00:40:43,244 [INFO] __main__:94 - Total logs processed: 6
2025-08-21 00:40:43,245 [INFO] __main__:96 - Parsed with regex: 4 (66.7%)
2025-08-21 00:40:43,245 [INFO] __main__:97 - Parsed with LLM: 1 (16.7%)
2025-08-21 00:40:43,246 [INFO] __main__:98 - Failed to parse: 1 (16.7%)
2025-08-21 00:40:43,246 [INFO] __main__:99 - Total successfully parsed: 5 (83.3%)
2025-08-21 00:40:43,246 [DEBUG] __main__:102 - Parsed logs:
2025-08-21 00:40:43,246 [DEBUG] __main__:104 - {'event_type': 'service_event', 'app_name': 'Background', 'summary': "Service 'Background' Intelligent Transfer: Service auto start demand start BITS"}
2025-08-21 00:40:43,247 [DEBUG] __main__:104 - {'event_type': 'service_event', 'app_name': 'Background', 'summary': "Service 'Background' Intelligent Transfer: Service demand start auto start BITS"}
2025-08-21 00:40:43,247 [DEBUG] __main__:104 - {'event_type': 'power_event', 'event_subtype': 'power_transition', 'summary': 'Power event: 21 32 158 1 259961883 34439 34439 34439 34439 160 0 true 32'}
2025-08-21 00:40:43,247 [DEBUG] __main__:104 - {'event_type': 'power_event', 'event_subtype': 'power_transition', 'summary': 'Power event: 0 259967187 0 0 0 259967187 0 83 true 32 32363743 0 true 0 274579 false true 0 7 0 true false 160 false 34439 34439 158 21 0 259967187 0 0 0 0 272169 false 34439 34439 259961883 0 0 0 34439 34439 0 0 4 0'}
2025-08-21 00:40:43,248 [DEBUG] __main__:104 - {'event_type': 'system_event', 'event_subtype': None, 'app_name': 'Microsoft Defender Antivirus', 'file_path': None, 'status': None, 'operation_code': None, 'summary': 'Security Intelligence Update for Microsoft Defender Antivirus - KB2267602 (Version 1.435.286.0) - Current Channel (Broad)'}
2025-08-21 00:40:43,250 [INFO] __main__:136 - Log processing complete.
2025-08-21 00:40:43,251 [INFO] __main__:137 - ================================================================================
2025-08-21 00:40:43,311 [DEBUG] httpcore.connection:47 - close.started
2025-08-21 00:40:43,312 [DEBUG] httpcore.connection:47 - close.complete
